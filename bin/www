#!/usr/bin/env node

var app = require( '../server' );
var http = require( 'http' );
var models = require( '../models');
var sequelize = require( 'sequelize' );


var port = process.env.PORT || 3000;
app.set( 'port', port );

var server = http.createServer( app );

// Create listeners
server.on( 'error', function() {
  console.error( 'Server error.' );
});

server.on('listening', function() {
  console.log( 'Server listening on port:', port );
});

// Syncronize the models
models.sequelize.sync()
  // when sucessful
  .then(function() {
    // start to listen
  });

server.listen( port );

